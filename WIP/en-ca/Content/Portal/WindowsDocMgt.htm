<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-ca" xml:lang="en-ca" class="_Skins_HTML5___Top_Navigation_Coronado" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Developers corner|[%=System.LinkedTitle%]|Portal applications and services">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Windows service - document management</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/MainStyles.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/select-language.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.previous-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.remove-highlight-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/highlight.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/TableStyles/PatternedRows.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/sanitize-html.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../A_Welcome pages/StartHere.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search our help and documentation" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="search-container">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_SearchTopics mc-component">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="row collapse">
                                        <div class="top-bar">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="Change language">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="select language" />
                                                    </button>
                                                    <button class="button needs-pie print-button" title="Print">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                    </button>
                                                    <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                    </button>
                                                    <button class="button needs-pie next-topic-button" title="Navigate next">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                    </button>
                                                    <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="remove highlight" />
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="nocontent">
                                                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                                </div>
                                            </div> </div>
                                        <div class="topic-layout">
                                            <div>
                                                <div class="side-menu">
                                                    <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/Release_2_TOC.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                                <div class="side-content">
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadside-content"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Search Tips</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>Search is based on keyword.</p>
                                                            <p><samp>Ex:&#160;"Procedures"</samp>
                                                            </p>
                                                            <p>Do not search with natural language</p>
                                                            <p><samp>Ex:&#160;"How do I write a new procedure?"</samp>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div><a class="cta" href="https://technet.microsoft.com/en-us/library/mt812330.aspx"><div class="cta center"><p>Dynamics 365 Help
									</p></div></a>
                                            </div>
                                            <div>
                                                <h1><a name="aanchor184"></a>
                                                    <MadCap:concept term="Portal" />Windows service - document management</h1>
                                                <p>The Document Management web service oversees the synchronization of documents and secure messages between the portal and EGCS.</p>
                                                <ul>
                                                    <li value="1">It is a Windows service named <code>EGCS.Portal.Service.DocumentManagement</code>.</li>
                                                    <li style="list-style-type: disc;" value="2">It is installed on a SharePoint server.</li>
                                                    <li style="list-style-type: disc;" value="3">The service runs constantly as a background task on the server.</li>
                                                    <li style="list-style-type: disc;" value="4">Internally, the service schedules and executes jobs to synchronize documents and secure messages.</li>
                                                    <li style="list-style-type: disc;" value="5">The service connects to the SharePoint farm through the server-side SharePoint object model.</li>
                                                    <li style="list-style-type: disc;" value="6">The service connects to the GCCF database.</li>
                                                    <li style="list-style-type: disc;" value="7">The service connects to the RDA web service.</li>
                                                    <li style="list-style-type: disc;" value="8">The service should be configured to run as the SharePoint service account.</li>
                                                </ul>
                                                <h2>Service Jobs</h2>
                                                <p>The Document Management service runs a set of jobs, which are configured via settings in <code>EGCS.Portal</code>. The class <code>DocumentManagementDispatcher</code> oversees the scheduling and execution of all jobs. The jobs execute on a repeating interval while the service is running.</p>
                                                <p>Generally speaking, the jobs exist in pairs: one job to scan or detect documents which need to be synchronized, and a second job to perform the actual document copy between the portal and GCPM.  Disabling either job of the pair will effectively stop synchronization for that type of document.</p>
                                                <p>Queues of documents and messages to be copied are maintained in the <code>GCCF</code> database.</p>
                                                <p>The Document Management service consists of the following jobs:</p>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Portal document scan</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="mc-table-style: url('../Resources/TableStyles/PatternedRows.css');width: 90%;" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Portal document scan</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>PortalDocumentScanWorker</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal </code>Settings</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>DocumentManagementPortalDocumentScanEnabled</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementPortalDocumentScanIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementPortalDocumentScanFetchLimit</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul style="list-style-type: disc;margin-left: 36pt;">
                                                                            <li style="list-style-type: disc;" value="1">Monitors the SharePoint changelog for all content databases on the portal.</li>
                                                                            <li style="list-style-type: disc;" value="2">Looks for new, updated, or deleted documents in the “Shared Documents” library of any zone. These are documents where <code>DocumentType == PortalDocument</code>.</li>
                                                                            <li style="list-style-type: disc;" value="3">Documents which need to be synchronized are recorded in the database table <code>GCCF.dbo.Document</code>. </li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Portal document copy</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Portal document copy</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>SharePointDocumentQueueWorker</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal Settings</code>
                                                                        </p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>DocumentManagementPortalDocumentCopyEnabled</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementPortalDocumentCopyIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementPortalDocumentCopyWorkerCount</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">Monitors database table <code>GCCF.dbo.Document </code>for documents which needs to be synchronized with GCPM where <code>DocumentType == PortalDocument</code>.</li>
                                                                            <li style="list-style-type: disc;" value="2">Calls RDA web service <code>DocumentManager</code> methods <code>DocumentPut()</code> or <code>DocumentDelete()</code> to copy documents to, or delete document from GCPM.</li>
                                                                            <li style="list-style-type: disc;" value="3">The job can copy multiple documents in parallel. Worker agents of class <code>SharePointDocumentCopyWorker </code>perform the actual document copy.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />RDA Record Scan</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 90%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>RDA&#160;record scan</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>RdaRecordScanWorker</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal Settings</code>
                                                                        </p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>DocumentManagementNewSiteScanEnabled</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementNewSiteScanIntervalSeconds</code>
                                                                            <br /><code>DocumentManagementRdaRecordScanEnabled</code>
                                                                            <br /><code>DocumentManagementRdaRecordScanIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementRdaRecordScanFetchLimit</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">Two separate jobs which use the same base class.</li>
                                                                            <li style="list-style-type: disc;" value="2">Monitors GCPM for new, updated, or deleted documents of <code>DocumentType == RDARecord</code> which needs to be copied to the portal.</li>
                                                                            <li style="list-style-type: disc;" value="3">Monitors the portal for newly created Client or Project Zones, where the entire set of <code>RDARecords</code> should be fetched to the portal.</li>
                                                                            <li style="list-style-type: disc;" value="4">Documents which need to be synchronized are recorded in the database table <code>GCCF.dbo.Document</code>. </li>
                                                                            <li style="list-style-type: disc;" value="5">Calls the RDA web service <code>DocumentManager </code>methods <code>DocumentListAll()</code>, <code>DocumentListUnsynced()</code>, and <code>DocumentAcknowledgeUnsynced()</code>.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />RDA Record Copy</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 90%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>RDA record copy</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>RdaRecordQueueWorker</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal Settings</code>
                                                                        </p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>DocumentManagementRdaRecordCopyEnabled</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementRdaRecordCopyIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementRdaRecordCopyWorkerCount</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">Monitors database table <code>GCCF.dbo.Document</code> for documents which needs to be synchronized with GCPM where <code>DocumentType == RDARecord.</code></li>
                                                                            <li style="list-style-type: disc;" value="2">Calls RDA web service <code>DocumentManager</code> methods <code>DocumentPut()</code> or <code>DocumentDelete()</code> to copy documents to, or delete document from GCPM.</li>
                                                                            <li style="list-style-type: disc;" value="3">The job can copy multiple documents in parallel. Worker agents of class <code>RdaRecordCopyWorker</code> perform the actual document copy.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Portal submission scan</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 90%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Portal submission scan</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>PortalSubmissionScanWorker</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal </code>Settings</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>DocumentManagementPortalSubmissionScanEnabled</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementPortalSubmissionScanIntervalSeconds</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul style="list-style-type: disc;margin-left: 36pt;">
                                                                            <li style="list-style-type: disc;" value="1">Monitors database table <code>GCCF.dbo.Submission</code> for new submissions (forms) from the portal for GCPM.</li>
                                                                            <li style="list-style-type: disc;" value="2">Calls RDA web service <code>DocumentManager </code>method <code>SubmitForm()</code> to submit form XML and PDF snapshot to GCPM for processing.</li>
                                                                            <li style="list-style-type: disc;" value="3">File attachments for the form submission are recorded in the database table <code>GCCF.dbo.Document</code> for later processing.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Portal submission copy</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Portal submission copy</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>SharePointDocumentQueueWorker</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal Settings</code>
                                                                        </p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>DocumentManagementPortalSubmissionCopyIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementPortalSubmissionCopyEnabled</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementPortalDocumentCopyWorkerCount</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">Monitors database table <code>GCCF.dbo.Document </code>for file submission attachments which needs to be synchronized with GCPM where <code>DocumentType == PortalSubmission</code>.</li>
                                                                            <li style="list-style-type: disc;" value="2">Calls RDA web service <code>DocumentManager </code>methods <code>DocumentPut()</code> or <code>DocumentDelete()</code> to copy documents to, or delete document from GCPM.</li>
                                                                            <li style="list-style-type: disc;" value="3">The job can copy multiple documents in parallel. Worker agents of class <code>SharePointDocumentCopyWorker</code> perform the actual document copy.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Secure message copy</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 90%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Secure message copy</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" style="width: 255px;" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>SecureMessageCopyWorker</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal Settings</code>
                                                                        </p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>DocumentManagementSecureMessageSyncEnabled</code>
                                                                        </p>
                                                                        <p><code>DocumentManagementSecureMessageSyncIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>SecureMessageSyncCount</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">The job performs four steps: sync new messages from the portal to the RDA, sync updated messages from the portal to the RDA, sync new messages from the RDA to the portal, sync updated messages from the RDA to the portal.</li>
                                                                            <li style="list-style-type: disc;" value="2">Calls methods on the RDA web service <code>SecureMessage</code>:&#160; <code>GetNew()</code>, <code>GetUnsynced()</code>,<code>SetSynced()</code>, <code>Add()</code>, <code>Sync()</code></li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <h2 class="Heading2">Prerequisites</h2>
                                                <ul>
                                                    <li value="1">A build of the <code>GC.GCCF </code>and <code>EGCS.Portal </code>solutions, which is assumed to be available in a <code>directory _Build</code>. The actual service comes from the <code>EGCS.Portal </code>solution, but <code>gccf.config </code>configuration is also required. <br /></li>
                                                    <li style="list-style-type: disc;" value="2">The <code>GCCF </code>database must have been provisioned.<br /></li>
                                                    <li style="list-style-type: disc;" value="3">The service account must have access to the <code>GCCF </code>database via the database role <code>GCCFUser</code>.<br /></li>
                                                </ul>
                                                <h2 class="Heading2">Installation</h2>
                                                <p>The service should be rebuilt and reinstalled whenever the <code>EGCS.Portal</code> project is recompiled, or the <code>GC.GCCF</code> project is recompiled. It has dependencies on DLLs from both of those projects.</p>
                                                <ol>
                                                    <li value="1">Install the Document Management Windows Service:<p><code>.\_Build\Scripts\Install-DocumentManagementService.ps1 –Config .\_Build\Config\&lt;environment&gt;.egcs.config</code></p><p>This command will:</p><ul><li value="1">Stop the service (if it is running).</li><li style="list-style-type: disc;" value="2">Install service files to path<br /><code>C:\Program Files\EGCS\EGCS.Portal.Service.DocumentManagement</code></li><li style="list-style-type: disc;" value="3">Register the service with Windows (if the service is not registered)<br />Service Name: <code>EGCS.Portal.Service.DocumentManagement</code></li><li style="list-style-type: disc;" value="4">Restart the service (if it was previously running)</li></ul></li>
                                                    <li value="2">Install <code>EGCS.Portal</code> configuration (<code>egcs.config</code>)<br /><p><code>.\_Build\Scripts\Install-GccfCommonDomain.ps1</code><br /></p><p>The configuration file is copied to the service directory.</p><p>The service will be stopped and restarted.</p></li>
                                                    <li value="3">Install <code>gccf.config</code> configuration.<p><code>.\_Build\Scripts\Install-GCCF_Config.ps1</code></p><p>The configuration file is copied to the service directory.</p><p>The service will be stopped and restarted.</p></li>
                                                    <li value="4">The first time that the service is installed, it will need a service account assigned, and must be manually started. This should only be done after both configuration files have been installed.<br /></li>
                                                </ol>
                                                <ul style="list-style-type: disc;margin-left: 36pt;">
                                                    <li style="list-style-type: disc;" value="1">Using the “Services” snap-in, configure a service account username and password for <code>EGCS.Portal.Service.DocumentManagement</code>. This should be the SharePoint service account.</li>
                                                    <li style="list-style-type: disc;" value="2">Set the service start-up mode to “Automatic” or “Automatic (Delayed Start)”.<br /></li>
                                                    <li style="list-style-type: disc;" value="3">Start the service via the “Services” snap-in, or via PowerShell.<p>Start-Service <code>EGCS.Portal.Service.DocumentManagement</code></p></li>
                                                </ul>
                                                <p><a class="MCHelpControl MCHelpControl-Concept conceptLink" data-mc-concepts="Portal" href="javascript:void(0);" data-mc-topics="About GCCF|GCCFAbout.htm#aanchor166||About the portal|AboutPortal.htm#aanchor395||About the portal|AboutPortal.htm#aanchor396||ADFS extensions web application|ADFSExtensionswebApp.htm#aanchor217||Alphinat SmartGuide documentation|SmartGuide/AlphinatDoc.htm#aanchor44||Authentication for GCCF users|GCCFAuthentication.htm#aanchor22||Authentication for RDA users|AuthenticationRDA.htm#aanchor214||Build and deploy SPFx apps|SPFxAppsBuildDeploy.htm#aanchor140||Configure forms for the portal|SmartGuide/ConfigureApplic on portal.htm#aanchor442||Create new forms|SmartGuide/CreateNewForms.htm#aanchor242||Data transfer from the portal to GCPM|DataTransfer.htm#aanchor256||Deploying forms for the portal with SmartGuide|SmartGuide/PortalFormDeploy.htm#aanchor0||Developing forms for the portal with SmartGuide|SmartGuide/PortalFormDev.htm#aanchor203||Developing portal forms - connections|SmartGuide/PortalFormDevConnections.htm#aanchor106||Developing SPFx Web Parts|SPFxAppsProjectFolders.htm#aanchor145||Documents on the portal |PortalDocs.htm#aanchor422||Dynamic portal forms|SmartGuide/PortalFormDynamic.htm#aanchor394||EGCS.Portal configuration|EGCSPortalConfig.htm#aanchor368||EGCS.Portal Visual Studio Solution|VSSolutionEGCSPortal.htm#aanchor321||FormManager web service overview|WebServicePortalFormMgr.htm#aanchor10||FormManager web service|WebServiceFormMgr.htm#aanchor127||GC.GCCF configuration|GCCFConfig.htm#aanchor388||GC.GCCF Visual Studio Solution|VSSolutionGCCF.htm#aanchor428||GCCF certificates|Cert-GCCF.htm#aanchor18||GCCF common domain web application|GCCFCommonDomainWebApp.htm#aanchor320||GCCF database|GCCFDatabase.htm#aanchor205||GCCF metadata|GCCFMetadata.htm#aanchor267||GCPM authentication|GCPMAuthentication.htm#aanchor8||GCPM&#160;Smartlet Structure |SmartGuide/PortalFormSmartletStructure.htm#aanchor213||Invite a GC&#160;Client to the portal|UsingPortal/InviteClient.htm#aanchor191||Navigate the portal|UsingPortal/NavigatePortal.htm#aanchor144||Portal - master page overview|PortalMasterPage.htm#aanchor25||Portal branding|PortalBranding.htm#aanchor261||Portal configuration - invitation email|PortalConfigInviteEmail.htm#aanchor227||Portal document integration with GCPM&#160;|PortalDocIntegGCPM.htm#aanchor231||Portal entity relationship diagram|../Modules/ERDs/ERD Portal.htm#aanchor131||Portal integration with GCPM|Portal-GCPMIntegration.htm#aanchor2||Portal release notes 1.0|PortalReleaseNotes1.0.htm#aanchor38||Portal security|PortalSecurity.htm#aanchor263||RDA web service and portal web service certificates|Cert-RDAWebService.htm#aanchor215||RDA web service|WebServiceRDA.htm#aanchor123||Reverse proxy server for the portal|PortalReverseProxy.htm#aanchor212||SharePoint - portal site structure|PortalSharepointSiteStructure.htm#aanchor156||SharePoint web service|WebserviceSharePoint.htm#aanchor313||SPFx apps for the portal|SPFxAppsPortal.htm#aanchor208||SSL certificate|Cert-SSL.htm#aanchor310||Submit forms on the portal|UsingPortal/SubmitForms.htm#aanchor357||Submit tabular data with a form|UsingPortal/SubmitFormTable.htm#aanchor162||Web services for portal integration|WebServicesPortal.htm#aanchor238||WebAPI&#160;web service|WebServiceWebAPI.htm#aanchor362||Windows service - document management|#aanchor184||Windows service - site creation|WindowsSiteCreation.htm#aanchor255"><span class="MCHelpControl-ConceptHotSpot_"><img class="MCHelpControl_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Concept Link Icon" />See Also</span></a>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>