<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-ca" xml:lang="en-ca" class="_Skins_HTML5___Top_Navigation_Coronado" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Developers corner|[%=System.LinkedTitle%]|Portal applications and services">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Windows service - site creation</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/MainStyles.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/select-language.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.previous-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.remove-highlight-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/highlight.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/TableStyles/PatternedRows.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/sanitize-html.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../A_Welcome pages/StartHere.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search our help and documentation" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="search-container">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_SearchTopics mc-component">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="row collapse">
                                        <div class="top-bar">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="Change language">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="select language" />
                                                    </button>
                                                    <button class="button needs-pie print-button" title="Print">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                    </button>
                                                    <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                    </button>
                                                    <button class="button needs-pie next-topic-button" title="Navigate next">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                    </button>
                                                    <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                                        <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="remove highlight" />
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="nocontent">
                                                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                                </div>
                                            </div> </div>
                                        <div class="topic-layout">
                                            <div>
                                                <div class="side-menu">
                                                    <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/Release_2_TOC.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                                <div class="side-content">
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadside-content"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Search Tips</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>Search is based on keyword.</p>
                                                            <p><samp>Ex:&#160;"Procedures"</samp>
                                                            </p>
                                                            <p>Do not search with natural language</p>
                                                            <p><samp>Ex:&#160;"How do I write a new procedure?"</samp>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div><a class="cta" href="https://technet.microsoft.com/en-us/library/mt812330.aspx"><div class="cta center"><p>Dynamics 365 Help
									</p></div></a>
                                            </div>
                                            <div>
                                                <h1><a name="aanchor255"></a>
                                                    <MadCap:concept term="Portal" />Windows service - site creation</h1>
                                                <p>The Document Management web service oversees the creation and maintenance of Client, Project, and Personal Zones for the portal.</p>
                                                <ul>
                                                    <li value="1">It is a Windows service named <code>EGCS.Portal.Service.SiteCreation.</code></li>
                                                    <li style="list-style-type: disc;" value="2">It is installed on a SharePoint server.</li>
                                                    <li style="list-style-type: disc;" value="3">The service runs constantly as a background task on the server.</li>
                                                    <li style="list-style-type: disc;" value="4">Internally, the service schedules and executes jobs to create and maintain portal zones (SharePoint site collections and sites).</li>
                                                    <li style="list-style-type: disc;" value="5">The service connects to the SharePoint farm through the server-side SharePoint object model.</li>
                                                    <li style="list-style-type: disc;" value="6">The service connects to the GCCF database.</li>
                                                    <li style="list-style-type: disc;" value="7">The service connects to the RDA web service.</li>
                                                    <li style="list-style-type: disc;" value="8">The service should be configured to run as the SharePoint service account.</li>
                                                </ul>
                                                <h2 class="Heading2">Service Jobs</h2>
                                                <p>The Site Creation service runs a set of jobs, which are configured via settings in <code>EGCS.Portal</code>. The class <code>SiteCreationDispatcher </code>oversees the scheduling and execution of all jobs. Most jobs execute on a repeating interval while the service is running, some execute on a fixed schedule.</p>
                                                <p>Queues of clients to be created, and the set of current portal zones in stored in the GCCF database.</p>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Client Zone Creation</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 90%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Client Zone creation</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>SiteWorkerClientQueue</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal Settings</code>
                                                                        </p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>SiteCreationClientSiteEnabled</code>
                                                                        </p>
                                                                        <p><code>SiteCreationClientSitePollIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>SiteCreationClientSiteWorkerCount</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">A Client Zone represents a GC Client in GCPM.</li>
                                                                            <li style="list-style-type: disc;" value="2">A Project Zone represents a project (FCProfile) in GCPM.</li>
                                                                            <li style="list-style-type: disc;" value="3">Monitors the table <code>GCCF.dbo.SiteQueueAccount </code>for new Client Zones which need to be created. Rows are added to this table via the portal web service (as called from the WebAPI web service).</li>
                                                                            <li style="list-style-type: disc;" value="4">The job can create multiple Client Zones in parallel. Worker agents of the class <code>SiteWorkerClient </code>perform the actual site creation.</li>
                                                                            <li style="list-style-type: disc;" value="5">When a Client Zone is created, Project Zones for all existing projects in GCPM are also created.</li>
                                                                            <li style="list-style-type: disc;" value="6">Uses web part templates, and SharePoint PnP site templates which are stored in the service directory.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Personal Zone Creation</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 90%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Personal Zone creation</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>SiteWorkerUserQueue</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal Settings</code>
                                                                        </p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>SiteCreationUserSiteEnabled</code>
                                                                        </p>
                                                                        <p><code>SiteCreationUserSitePollIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>SiteCreationUserSiteWorkerCount</code>
                                                                        </p>
                                                                        <p><code>SiteCreationUserSiteMaximumFailedCount</code>
                                                                        </p>
                                                                        <p><code>SiteCreationUserSiteQueueSize</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">A Personal Zone is a user’s private site on the portal.</li>
                                                                            <li style="list-style-type: disc;" value="2">A user is linked to a <code>PortalUser</code> in GCPM.</li>
                                                                            <li style="list-style-type: disc;" value="3">Monitors the table <code>GCCF.dbo.SiteQueueUser</code> to keep count of the number of unassigned Personal Zones. If the number of unassigned zones falls below <code>SiteCreationUserSiteQueueSize</code>, the job will begin creating new Zones. The job can create multiple Personal Zones in parallel. Worker agents of the class <code>SiteWorkerUser</code> perform the actual site creation.</li>
                                                                            <li style="list-style-type: disc;" value="4">Uses web part templates, and SharePoint PnP site templates which are stored in the service directory.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Client Zone Restart</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Client Zone restart</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>SiteWorkerClientRestart</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal Settings</code>
                                                                        </p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>SiteCreationClientSiteRestartEnabled</code>
                                                                        </p>
                                                                        <p><code>SiteCreationClientSiteRestartIntervalSeconds</code>
                                                                        </p>
                                                                        <p><code>SiteCreationClientSiteWorkerCount</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">Monitors the table <code>GCCF.dbo.SiteQueueAccount</code> for Client Zones which have failed setup. Resets the status of those Client Zones so that the Client Zone creation job will attempt to create them again.</li>
                                                                            <li style="list-style-type: disc;" value="2">Delete any existing SharePoint site collection for a failed Client Zone.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Client Zone Maintenance</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <table style="width: 90%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                                                            <caption>Client Zone maintenance</caption>
                                                            <col class="TableStyle-PatternedRows-Column-Regular" style="width: 162px;" />
                                                            <col class="TableStyle-PatternedRows-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows-Head-Header1">
                                                                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">&#160;</th>
                                                                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">&#160;</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                                                                        <p>Class</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                                                                        <p><code>SiteWorkerClientMaintenance</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                                                                        <p><code>EGCS.Portal</code> Settings</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                                                                        <p><code>SiteCreationClientSiteMaintenanceEnabled</code>
                                                                        </p>
                                                                        <p><code>SiteCreationClientSiteMaintenanceStartTime</code>
                                                                        </p>
                                                                        <p><code>SiteCreationClientSiteMaintenanceIntervalMinutes</code>
                                                                        </p>
                                                                    </td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows">
                                                                        <p>Notes</p>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">
                                                                        <ul>
                                                                            <li value="1">Unlike the other jobs, this job has a fixed start time.</li>
                                                                            <li style="list-style-type: disc;" value="2">This is a relatively expensive job. It needs to query information on every Client and Project Zone on the portal from GCPM (which can run into tens of thousands of sites). Suggested that this job should only be run once per day, during overnight hours.</li>
                                                                            <li style="list-style-type: disc;" value="3">Checks every Client zone on the portal to determine if new Projects have been added in GCPM. Adds new Project zones to Client Zones.</li>
                                                                            <li style="list-style-type: disc;" value="4">Ensures that the English and French name of Client Zones and Project Zones is up to date in database tables <code>GCCF.dbo</code>.account and <code>GCCF.dbo.egcs_fc_Profile</code>.</li>
                                                                        </ul>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <h2 class="Heading2">Prerequisites</h2>
                                                <ul>
                                                    <li value="1">A build of the <code>GC.GCCF </code>and <code>EGCS.Portal </code>solutions, which is assumed to be available in a directory _Build. The actual service comes from the <code>EGCS.Portal</code> solution, but <code>gccf.config </code>configuration is also required.<br /></li>
                                                    <li style="list-style-type: disc;" value="2">The <code>GCCF</code> database must have been provisioned.<br /></li>
                                                    <li style="list-style-type: disc;" value="3">The service account must have access to the <code>GCCF</code> database via the database role <code>GCCFUser</code>.<br /></li>
                                                    <li style="list-style-type: disc;" value="4">The SharePoint PnP PowerShell components must be installed on the SharePoint server:<br /><code>Install-Module SharePointPnPPowerShell2016</code></li>
                                                </ul>
                                                <ul style="list-style-type: disc;margin-left: 36pt;">
                                                    <li style="list-style-type: disc;" value="1">Add SharePoint managed paths to support Client Zones and Personal Zones. Paths should match settings from <code>EGCS.Portal –  UrlClientSiteRoot, UrlUserSiteRoot</code>.<br /><code>New-SPManagedPath -RelativeURL /client -WebApplication </code><code href="../../../../Downloads/Windows Service - Site Creation.docx">https://&lt;portal</code><code> web application&gt;</code><br /><code>New-SPManagedPath -RelativeURL /my-moi -WebApplication </code><code href="../../../../Downloads/Windows Service - Site Creation.docx">https://&lt;portal</code><code> web application&gt;</code></li>
                                                    <li style="list-style-type: disc;" value="2">The root site collection (/) of the portal must exist.<br /></li>
                                                    <li style="list-style-type: disc;" value="3">Enable SharePoint PnP creation of site collections. This script will trigger an IISRESET.<br />Create a new SharePoint site to host the Tenant Administration function for SharePoint PnP. This site will be used to create new site collections by the service. It will not be used by portal users. The URL is assumed to be <code>/sites/TenantAdmin</code> but can be changed in  <code>EGCS.Portal</code> configuration.<br /><code>New-SPSite -Url https://&lt;portal&gt;/sites/TenantAdmin -OwnerAlias "i:0#.w|&lt;owner account&gt;"</code></li>
                                                    <li style="list-style-type: disc;" value="4">Enable Tenant Administration and configure the new site.<code><br />_Build\Scripts\allowtenantapiv16.ps1 -WebApplicationUrl https://&lt;portal web application&gt;</code><p><code>$site = Get-SPSite https://&lt;portal web application&gt;/sites/TenantAdmin</code></p><p><code>$site.AdministrationSiteType = [Microsoft.SharePoint.SPAdministrationSiteType]::TenantAdministration</code></p><p><code>$site.Update()</code></p></li>
                                                </ul>
                                                <h2 class="Heading2">Installation</h2>
                                                <p>The service should be rebuilt and reinstalled whenever the <code>EGCS.Portal </code>project is recompiled, or the <code>GC.GCCF</code> project is recompiled. It has dependencies on DLLs from both of those projects.</p>
                                                <ol>
                                                    <li value="1">Install the Document Management Windows Service<br /><code>.\_Build\Scripts\Install- SiteCreationService.ps1 –Config .\_Build\Config\&lt;environment&gt;.egcs.config</code><br />This command will:<ul><li value="1">Stop the service (if it is running)</li><li style="list-style-type: disc;" value="2">Install service files to path<br /><code>C:\Program Files\EGCS\EGCS.Portal.Service.SiteCreation</code></li><li style="list-style-type: disc;" value="3">Register the service with Windows (if the service is not registered)<br />Service Name:<code> EGCS.Portal.Service.SiteCreation</code></li><li style="list-style-type: disc;" value="4">Restart the service (if it was previously running)</li></ul></li>
                                                    <li value="2">Install <code>EGCS.Portal </code>configuration (egcs.config):<br /><p><code>.\_Build\Scripts\Install-GccfCommonDomain.ps1</code><br /></p><p>The configuration file is copied to the service directory.</p><p>The service will be stopped and restarted.</p></li>
                                                    <li value="3">Install <code>gccf.config </code>configuration<p><code>.\_Build\Scripts\Install-GCCF_Config.ps1</code></p><p>The configuration file is copied to the service directory.</p><p>The service will be stopped and restarted.<br /></p></li>
                                                    <li value="4">The first time that the service is installed, it will need a service account assigned, and must be manually started. This should only be done after both configuration files have been installed.<br /><ol><li style="list-style-type: disc;" value="1">Using the “Services” snap-in, configure a service account username and password for <code>EGCS.Portal.Service.SiteCreation</code>. This should be the SharePoint service account.</li><li style="list-style-type: disc;" value="2">Set the service start-up mode to “Automatic” or “Automatic (Delayed Start)”<br /></li><li style="list-style-type: disc;" value="3">Start the service via the “Services” snap-in, or via PowerShell.</li></ol><ul><li value="1"><code>Start-Service EGCS.Portal.Service.SiteCreation</code> </li></ul></li>
                                                </ol>
                                                <p><a class="MCHelpControl MCHelpControl-Concept conceptLink" data-mc-concepts="Portal" href="javascript:void(0);" data-mc-topics="About GCCF|GCCFAbout.htm#aanchor166||About the portal|AboutPortal.htm#aanchor395||About the portal|AboutPortal.htm#aanchor396||ADFS extensions web application|ADFSExtensionswebApp.htm#aanchor217||Alphinat SmartGuide documentation|SmartGuide/AlphinatDoc.htm#aanchor44||Authentication for GCCF users|GCCFAuthentication.htm#aanchor22||Authentication for RDA users|AuthenticationRDA.htm#aanchor214||Build and deploy SPFx apps|SPFxAppsBuildDeploy.htm#aanchor140||Configure forms for the portal|SmartGuide/ConfigureApplic on portal.htm#aanchor442||Create new forms|SmartGuide/CreateNewForms.htm#aanchor242||Data transfer from the portal to GCPM|DataTransfer.htm#aanchor256||Deploying forms for the portal with SmartGuide|SmartGuide/PortalFormDeploy.htm#aanchor0||Developing forms for the portal with SmartGuide|SmartGuide/PortalFormDev.htm#aanchor203||Developing portal forms - connections|SmartGuide/PortalFormDevConnections.htm#aanchor106||Developing SPFx Web Parts|SPFxAppsProjectFolders.htm#aanchor145||Documents on the portal |PortalDocs.htm#aanchor422||Dynamic portal forms|SmartGuide/PortalFormDynamic.htm#aanchor394||EGCS.Portal configuration|EGCSPortalConfig.htm#aanchor368||EGCS.Portal Visual Studio Solution|VSSolutionEGCSPortal.htm#aanchor321||FormManager web service overview|WebServicePortalFormMgr.htm#aanchor10||FormManager web service|WebServiceFormMgr.htm#aanchor127||GC.GCCF configuration|GCCFConfig.htm#aanchor388||GC.GCCF Visual Studio Solution|VSSolutionGCCF.htm#aanchor428||GCCF certificates|Cert-GCCF.htm#aanchor18||GCCF common domain web application|GCCFCommonDomainWebApp.htm#aanchor320||GCCF database|GCCFDatabase.htm#aanchor205||GCCF metadata|GCCFMetadata.htm#aanchor267||GCPM authentication|GCPMAuthentication.htm#aanchor8||GCPM&#160;Smartlet Structure |SmartGuide/PortalFormSmartletStructure.htm#aanchor213||Invite a GC&#160;Client to the portal|UsingPortal/InviteClient.htm#aanchor191||Navigate the portal|UsingPortal/NavigatePortal.htm#aanchor144||Portal - master page overview|PortalMasterPage.htm#aanchor25||Portal branding|PortalBranding.htm#aanchor261||Portal configuration - invitation email|PortalConfigInviteEmail.htm#aanchor227||Portal document integration with GCPM&#160;|PortalDocIntegGCPM.htm#aanchor231||Portal entity relationship diagram|../Modules/ERDs/ERD Portal.htm#aanchor131||Portal integration with GCPM|Portal-GCPMIntegration.htm#aanchor2||Portal release notes 1.0|PortalReleaseNotes1.0.htm#aanchor38||Portal security|PortalSecurity.htm#aanchor263||RDA web service and portal web service certificates|Cert-RDAWebService.htm#aanchor215||RDA web service|WebServiceRDA.htm#aanchor123||Reverse proxy server for the portal|PortalReverseProxy.htm#aanchor212||SharePoint - portal site structure|PortalSharepointSiteStructure.htm#aanchor156||SharePoint web service|WebserviceSharePoint.htm#aanchor313||SPFx apps for the portal|SPFxAppsPortal.htm#aanchor208||SSL certificate|Cert-SSL.htm#aanchor310||Submit forms on the portal|UsingPortal/SubmitForms.htm#aanchor357||Submit tabular data with a form|UsingPortal/SubmitFormTable.htm#aanchor162||Web services for portal integration|WebServicesPortal.htm#aanchor238||WebAPI&#160;web service|WebServiceWebAPI.htm#aanchor362||Windows service - document management|WindowsDocMgt.htm#aanchor184||Windows service - site creation|#aanchor255"><span class="MCHelpControl-ConceptHotSpot_"><img class="MCHelpControl_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Concept Link Icon" />See Also</span></a>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>