<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-ca" xml:lang="en-ca" class="_Skins_HTML5___Top_Navigation_Coronado" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Configuration Tools|Crowe EditAble CRM Grid|Advanced Development using EditAble CRM Grid|Custom Fields">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Using custom JavaScript functions</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/MainStyles.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/select-language.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.select-skin-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/select-skin.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.previous-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.remove-highlight-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/highlight.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <style>html
{
	overflow: hidden;
	margin: 0;
	padding: 0;
	height: 100%;
}

body
{
	overflow: hidden;
	margin: 0;
	padding: 0;
	height: 100%;
}

#non-scrolling-area
{
	padding: 0px 10px 0 10px;
	background-color: #002050;
}

#container
{
	overflow: auto;
}

#content
{
	padding: 0 10px 5px 10px;
}

</style>
        <link href="CHMstyles.css" rel="stylesheet" />
        <script src="../js/jquery-1.11.1.min.js">
        </script>
        <script src="../js/nsa.js">
        </script>
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../A_Welcome pages/StartHere.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search our help and documentation" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container" data-mc-content-body="True">
                                <div class="search-container">
                                    <form class="search" action="#">
                                        <div class="search-bar search-bar-container needs-pie _Skins_SearchTopics mc-component">
                                            <input class="search-field needs-pie" type="search" placeholder="Search our help and documentation" />
                                            <div class="search-filter-wrapper">
                                                <div class="search-filter">
                                                    <div class="search-filter-content">
                                                        <ul>
                                                            <li>All Files</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="search-submit-wrapper" dir="ltr">
                                                <div class="search-submit" title="Search">
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="row collapse">
                                    <div class="top-bar">
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie select-language-button" title="Change language">
                                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="select language" />
                                                </button>
                                                <button class="button needs-pie select-skin-button" title="Select skin">
                                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="select skin" />
                                                </button>
                                                <button class="button needs-pie print-button" title="Print">
                                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                </button>
                                                <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                </button>
                                                <button class="button needs-pie next-topic-button" title="Navigate next">
                                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                </button>
                                                <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="remove highlight" />
                                                </button>
                                            </div>
                                        </div>
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div> </div>
                                    <div class="topic-layout">
                                        <div>
                                            <div class="side-menu">
                                                <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/Release_2_TOC.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                </ul>
                                            </div>
                                            <div class="side-content">
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadside-content"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Search Tips</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>Search is based on keyword.</p>
                                                        <p><samp>Ex:&#160;"Procedures"</samp>
                                                        </p>
                                                        <p>Do not search with natural language</p>
                                                        <p><samp>Ex:&#160;"How do I write a new procedure?"</samp>
                                                        </p>
                                                    </div>
                                                </div>
                                            </div><a class="cta" href="https://technet.microsoft.com/en-us/library/mt812330.aspx"><div class="cta center"><p>Dynamics 365 Help
									</p></div></a>
                                        </div>
                                        <div>
                                            <div id="non-scrolling-area">
                                                <p class="ps10"><a href="IDH_Topic120.htm" class="hs2">Crowe EditAble CRM Grid</a><span class="ts8">&#160;| </span><a href="IDH_Topic350.htm" class="hs2">Advanced Development using EditAble CRM Grid</a><span class="ts8">&#160;| </span><a href="IDH_Topic470.htm" class="hs2" name="kanchor122">Custom Fields</a>
                                                    <br />
                                                    <br /><span class="ts5"><a name="kanchor123"></a>Using custom JavaScript functions</span>
                                                </p>
                                            </div>
                                            <div id="container">
                                                <div id="content-background">
                                                    <div id="content">
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">The real power of using Custom Fields – Applying your own custom function to generate and return the value you want.&#160; Custom functions can be used for very simple custom fields or very complex custom fields.&#160; We’ll show examples of several different uses below.</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">This function will run as the records are retrieved from CRM.&#160; Additionally, the function is executed for every individual record that is retrieved.&#160; Keep this in mind when designing and writing your custom function, as it may have a significant impact on the performance on the EditAble CRM Grid’s query performance depending on what the function is doing and how many records are being returned.</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">The value that will be passed back to the EditAble CRM Grid for processing in your custom EditAble CRM Grid Column is whatever you return from your custom function.&#160; Noting that, be sure specify an appropriate Data Type when configuring the column (shown below).</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p>
                                                            <img width="493" height="165" border="0" src="../Resources/Images/CroweHelp/Image(92).png" />
                                                        </p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p><span class="ts13">Custom Function Context</span>
                                                        </p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">Similar to EditAble CRM Grid Events, Custom Functions are sent a context object as a parameter.&#160; The context for Custom Functions an attribute named “Data” and an attribute named "FormattedData".&#160; The “Data” attribute is an object that contains all of the unformatted values being returned from CRM for the current record, while the "FormattedData" attribute contains all formatted value. This includes all Standard EditAble CRM Grid Column fields, as well as baseline fields EditAble CRM Grid returns automatically, like StateCode, the record’s ID field, and currency information such as ExchangeRate and TransactionCurrencyId. Context "Data" and "FormattedData" field return types are outlined in the related sections in <a href="IDH_Topic380.htm" class="hs0">Get or Set the value of a Grid Column</a>.</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">Note that other Custom Fields you may have configured on your EditAble CRM Grid will not be part of the context.</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p><span class="ts13">Creating a Simple Custom Function</span>
                                                        </p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">To start, we’ll create the simplest Custom Function-based EditAble CRM Grid Column possible.&#160; In this example, our custom function is just going to return a static value:</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p>
                                                            <img width="693" height="90" border="0" src="../Resources/Images/CroweHelp/Image(194).png" />
                                                        </p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">This means every record in our EditAble CRM Grid will show the text “My Custom Value” for our custom EditAble CRM Grid Column:</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p>
                                                            <img width="518" height="153" border="0" src="../Resources/Images/CroweHelp/Image(94).png" />
                                                        </p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p><span class="ts13">Creating a Calculated Custom Function</span>
                                                        </p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">While displaying the same value for every row may occasionally be useful, you will typically want to your custom field to show dynamic values.&#160; Keep in mind though, that since custom fields are not directly tied to a CRM attribute the value does not get saved anywhere.&#160; Conceptually, it is a display-only or “virtual” field.</p>
                                                        <p class="ps1">A good example of a Custom Field showing dynamically generated values are scenarios where you want to show how long it has been since something happened.&#160; For example, the number of days a Case has been opened, or the age of an Opportunity’s current sales stage.&#160; These are great examples because their values literally change every day.&#160; You could create a CRM attribute that stores the data, but you would then need to have additional processes to recalculate that data daily.</p>
                                                        <p class="ps1"><a name="kanchor124"></a>For our example, we are going to create a Custom Field that shows a Contact’s current age.&#160; We’ll create an EditAble CRM Grid Configuration based on the Contact entity and add First Name, Last Name, and Birthday as columns:</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;<img width="580" height="273" border="0" src="../Resources/Images/CroweHelp/Image(95).png" /></p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">To calculate the Contact’s Age based on their Birthdate, our custom function will look like this.&#160; Note that for demonstration purposes we are using a simplified age calculation that will result in the age as of the end of the current year.</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p>
                                                            <img width="694" height="389" border="0" src="../Resources/Images/CroweHelp/Image(301).png" />
                                                        </p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">Logic the code is executing:</p>
                                                        <p class="ps7"><span style="font-family: Tahoma;font-size: 10pt;color: Black;">1.</span><span style="display: inline-block;width: 13px;"></span>Use the context parameter to access the BirthDate value of the current record.</p>
                                                        <p class="ps7"><span style="font-family: Tahoma;font-size: 10pt;color: Black;">2.</span><span style="display: inline-block;width: 13px;"></span>If the record has a BirthDate value, calculate the age and return it as a string (i.e. “35 Years”).</p>
                                                        <p class="ps7"><span style="font-family: Tahoma;font-size: 10pt;color: Black;">3.</span><span style="display: inline-block;width: 13px;"></span>If the record does not have a BirthDate value, simply return a blank string.</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">When applied to our new Custom EditAble CRM Grid Column, our grid now looks like this:</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;<img width="576" height="269" border="0" src="../Resources/Images/CroweHelp/Image(97).png" /></p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p><span class="ts7">See Also</span>
                                                        </p>
                                                        <p class="ps7"><span style="font-family: Symbol;font-size: 10pt;color: Black;">·</span><span style="display: inline-block;width: 18px;"></span><a href="IDH_Topic650.htm" class="hs0">Adding custom JavaScript functions</a>
                                                        </p>
                                                        <p class="ps7"><span style="font-family: Symbol;font-size: 10pt;color: Black;">·</span><span style="display: inline-block;width: 18px;"></span><a href="IDH_Topic160.htm" class="hs0">Column configuration</a>
                                                        </p>
                                                        <p class="ps7"><span style="font-family: Symbol;font-size: 10pt;color: Black;">·</span><span style="display: inline-block;width: 18px;"></span><a href="IDH_Topic750.htm" class="hs0">Important information about Custom Fields</a>
                                                        </p>
                                                        <p class="ps7"><span style="font-family: Symbol;font-size: 10pt;color: Black;">·</span><span style="display: inline-block;width: 18px;"></span><a href="IDH_Topic380.htm" class="hs0">Get or set the value of a Grid Column</a>
                                                        </p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps1">&#160;</p>
                                                        <p class="ps12">&#160;</p>
                                                        <p class="ps12">&#160;</p>
                                                        <p class="ps12">&#160;</p>
                                                        <div>
                                                            <div class="hline0">
                                                            </div>
                                                        </div>
                                                        <div align="center">
                                                            <table style="width: 100%;border-collapse: collapse;border-top: solid 0px Black;border-right: solid 0px Black;border-bottom: solid 0px Black;border-left: solid 0px Black;" width="100%" cellspacing="2" cellpadding="0">
                                                                <tr style="border-top: none;border-right: none;border-bottom: none;border-left: none;">
                                                                    <td style="border-top: solid 0px Black;border-right: solid 0px Black;border-bottom: solid 0px Black;border-left: solid 0px Black;" valign="top">
                                                                        <p class="ps8">Crowe EditAble CRM Grid for Microsoft Dynamics CRM™</p>
                                                                    </td>
                                                                    <td style="border-top: solid 0px Black;border-right: solid 0px Black;border-bottom: solid 0px Black;border-left: solid 0px Black;" valign="top">
                                                                        <p class="ps9">Copyright © 2018 Crowe Horwath LLP</p>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                        <p><span class="ts0">&#160;</span>
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>